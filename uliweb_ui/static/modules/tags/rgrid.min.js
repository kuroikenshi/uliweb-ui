riot.tag2("rgrid",'<query-condition if="{has_query}" rules="{query_ules}" fields="{query_fields}" layout="{query_layout}"></query-condition> <div if="{tools}" class="rgrid-tools pull-left"> <button each="{btn in tools}" class="{btn.class}" onclick="{btn.onclick}">{btn.label}</button> </div> <rtable cols="{cols}" options="{rtable_options}" data="{data}" start="{start}"></rtable> <div class="clearfix tools"> <pagination if="{pagination}" data="{data}" url="{url}" page="{page}" total="{total}" limit="{limit}" onpagechanged="{onpagechanged}"></pagination> <div if="{footer_tools}" class="pull-right"> <button each="{btn in footer_tools}" class="btn btn-flat btn-sm btn-default" onclick="{btn.onClick}">{btn.label}</button> </div> </div>','rgrid .rgrid-tools,[riot-tag="rgrid"] .rgrid-tools,[data-is="rgrid"] .rgrid-tools{margin-bottom:5px;} rgrid .rgrid-tools button,[riot-tag="rgrid"] .rgrid-tools button,[data-is="rgrid"] .rgrid-tools button{margin-right:4px;}',"",function(t){var i=this;this.data=new DataSet,this.cols=t.cols,this.url=t.url,this.page=t.page||1,this.limit=t.limit||10,this.total=t.total||0,this.pagination=void 0==t.pagination||t.pagination,this.has_query=void 0!==t.query,this.query=t.query||{},this.query_rules=this.query.rules||{},this.query_fields=this.query.fields||[],this.query_layout=this.query.layout||[],this.start=(this.page-1)*this.limit,this.footer_tools=t.footer_tools||[],this.tools=t.tools||[],this.rtable_options={theme:t.theme,nameField:t.nameField||"name",labelField:t.labelField||"title",indexCol:t.indexCol,checkCol:t.checkCol,multiSelect:t.multiSelect,maxHeight:t.maxHeight,minHeight:t.minHeight,height:t.height,width:t.width,rowHeight:t.rowHeight,container:$(this.root).parent(),noData:t.noData,tree:t.tree,expanded:void 0===t.expanded||t.expanded,useFontAwesome:void 0===t.useFontAwesome||t.useFontAwesome,parentField:t.parentField,orderField:t.orderField,levelField:t.levelField,treeField:t.treeField,onDblclick:t.onDblclick,onClick:t.onClick,onMove:t.onMove,onEdit:t.onEdit,onEdited:t.onEdited,draggable:t.draggable,editable:t.editable},this.onpagechanged=function(t){i.start=(t-1)*i.limit,i.update()},this.on("mount",function(){for(var t,e=0,o=this.tools.length;e<o;e++){t=this.tools[e];var l=function(t){return function(e){return t.onClick.call(i,e)}};t.onclick=l(t),t["class"]=t["class"]||"btn btn-flat btn-sm btn-primary"}this.table=this.root.querySelector("rtable"),this.root.add=this.table.add,this.root.addFirstChild=this.table.addFirstChild,this.root.update=this.table.update,this.root.remove=this.table.remove,this.root.get=this.table.get,this.root.load=this.load,this.root.insertBefore=this.table.insertBefore,this.root.insertAfter=this.table.insertAfter,this.root.get_selected=this.table.get_selected,this.root.expand=this.table.expand,this.root.collapse=this.table.collapse,this.root.is_selected=this.table.is_selected,this.root.move=this.table.move,this.root.save=this.table.save,this.root.diff=this.table.diff,this.load()}),this.load=function(t){i.url=t||i.url,i.data.load(i.url,function(t){return i.total=t.total,t.rows}).done(function(){i.update(),i.data.save()})}});